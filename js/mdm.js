var currentlyShownUser = "", numUsersShown = 0; function set_up_screen() { center_login_box(), center_date_time(), center_users_area(), $("#date_time").offset().top <= 0 && setInterval(set_up_screen, 100) } function mdm_disable() { document.getElementById("entry").value = "disabled", document.getElementById("entry").disabled = "disabled", document.getElementById("ok_button").disabled = "disabled" } function mdm_enable() { document.getElementById("entry").value = "", document.getElementById("entry").disabled = !1, document.getElementById("ok_button").disabled = !1 } function set_welcome_message(e) { document.getElementById("welcome_message").innerHTML = e } function mdm_prompt(e) { mdm_enable(), $("#entry").css("color", "#777"), $("#entry").bind({ click: function () { $(this).css("color", "#777"), reset_cursor_position() }, keydown: function () { $(this).val(""), $(this).css("color", "#000"), $(this).unbind("keydown"), $(this).unbind("click") } }), document.getElementById("entry").type = "text", document.getElementById("entry").value = e.split(":")[0], reset_cursor_position() } function mdm_noecho(e) { mdm_enable(), $("#entry").css("color", "#777"), $("#entry").bind({ click: function () { $(this).css("color", "#777"), reset_cursor_position() }, keydown: function () { $(this).attr("type", "password"), $(this).val(""), $(this).css("color", "#000"), $(this).unbind("keydown"), $(this).unbind("click") } }), document.getElementById("entry").type = "text", document.getElementById("entry").value = e.split(":")[0], reset_cursor_position() } function mdm_msg(e) { document.getElementById("message").innerHTML = e } function mdm_timed(e) { "" != e ? (document.getElementById("timed").style.display = "block", document.getElementById("notify_area_timed").style.display = "block") : (document.getElementById("timed").style.display = "none", document.getElementById("notify_area_timed").style.display = "none"), document.getElementById("timed").innerHTML = e } function mdm_error(e) { "" != e ? (document.getElementById("error").style.display = "block", document.getElementById("notify_area_error").style.display = "block") : (document.getElementById("error").style.display = "none", document.getElementById("notify_area_error").style.display = "none"), document.getElementById("error").innerHTML = e } function send_login() { var e = document.getElementById("entry").value; return mdm_disable(), alert("LOGIN###" + e), !1 } function center_users_area() { $("#users").css("top", $(window).height() / 2 - $("#users").height() / 2) } function center_date_time() { $("#date_time").css("top", $(window).height() / 2 - $("#date_time").height() / 2) } function center_login_box() { $(".login_box").css("top", $(window).height() / 2 - $(".login_box").height() / 2) } function reset_cursor_position() { $("#entry").focus(), $("#entry")[0].setSelectionRange(0, 0) } function show_hidden_users() { $(".login_box").removeClass("login_box"), 0 != numUsersShown && $("#default_login").html("Other"), $(".user-info").fadeIn(314), $(".user-info-hr").show(), currentlyShownUser = "" } function close_login_box() { $(".login_box").hide(150, show_hidden_users), $(".extra_controls").remove(), $("#ok_button").remove(), $("#entry").remove(), alert("USER###") } function add_extra_controls() { $(".login_box").append("<input id='entry' type='text' class='input-level-block'><button type='submit' class='btn' id='ok_button'></button>"), $("#ok_button").html($("#hidden_ok_label").html()), $(".login_box").contents().wrapAll("<form onSubmit='return send_login();' />"), $(".login_box").prepend("<div class='extra_controls'><a href='javascript:close_login_box();' class='close pull-left'><i class='icon-arrow-left'></i></a><a href='#settingsModal' data-toggle='modal' class='close pull-right'><i class='icon-cog'></i></a></div>"), reset_cursor_position() } function user_clicked(e, t, n) { currentlyShownUser != e && ($(".login_box").removeClass("login_box"), $(".user-info").hide(), $(".user-info-hr").hide(), $("." + e).addClass("login_box"), add_extra_controls(), n ? ($(".login_box .user-gecos").html("Login"), mdm_prompt($("#hidden_uname_label").html())) : alert("USER###" + e), center_login_box(), $(".login_box").show(150, reset_cursor_position), currentlyShownUser = e) } function create_separator() { var e = document.createElement("hr"); return e.style.border = "none", e.style.borderBottom = "1px solid #e5e5e5", e } function mdm_add_user(e, t, n) { if (!(numUsersShown + 1 > maxUsersShown)) { var s = document.createElement("div"); s.setAttribute("class", "user-info " + e); var o = document.createElement("a"); o.setAttribute("href", "javascript:user_clicked('" + e + "', '" + t + "', false)"); var r = document.createElement("img"); r.setAttribute("class", "img-polaroid user-img"), r.setAttribute("align", "left"), r.setAttribute("src", "file:///home/" + e + "/.face"), r.setAttribute("onerror", "this.src='img/default-user.svg';"); var i = document.createElement("div"); i.setAttribute("class", "user-gecos"), i.innerHTML = t; var l = document.createElement("div"); if (l.setAttribute("class", "username"), l.innerHTML = e, "" != n) { var d = document.createElement("div"); d.setAttribute("class", "user-status"), d.innerHTML = n } s.appendChild(o), o.appendChild(r), o.appendChild(i), o.appendChild(l), "" != n && o.appendChild(d); var c = document.getElementById("users"), a = c.getElementsByClassName("user-info").length; 1 == a && (document.getElementById("default_login").innerHTML = "Other", c.insertBefore(create_separator(), c.children[0])), c.insertBefore(s, c.children[a - 1]), $("#users").css("top", $(window).height() / 2 - $("#users").height() / 2), numUsersShown++ } } function mdm_add_session(e, t) { var n = (e = e.replace("Ubuntu", "Unity")).toLowerCase(); n = (n = (n = n.replace(/ /g, "-")).replace(/\(/g, "")).replace(/\)/g, ""); var s = document.createElement("li"), o = document.createElement("a"); o.setAttribute("href", "javascript:alert('SESSION###" + e + "###" + t + "');select_session('" + e + "','" + t + "');"); var r = document.createElement("img"); r.setAttribute("class", "session-picture"), r.setAttribute("src", "img/sessions/" + n + ".svg"), r.setAttribute("onerror", "this.src='img/sessions/default.svg';"); var i = document.createTextNode(e); s.appendChild(o), o.appendChild(r), o.appendChild(i), document.getElementById("sessions").appendChild(s) } function select_session(e, t) { var n = e.toLowerCase(); n = (n = (n = n.replace(/ /g, "-")).replace(/\(/g, "")).replace(/\)/g, ""), document.getElementById("current_session_picture").src = "img/sessions/" + n + ".svg", document.getElementById("current_session_picture").title = e, $("#selected_session_text").html(e) } function mdm_add_language(e, t) { var n = t.toLowerCase(); n = n.replace(".utf-8", ""), bits = n.split("_"), 2 == bits.length && (n = bits[1]); var s = document.createElement("li"), o = document.createElement("a"); o.setAttribute("href", "javascript:alert('LANGUAGE###" + t + "')"); var r = document.createElement("img"); r.setAttribute("class", "language-picture"), r.setAttribute("src", "img/languages/" + n + ".png"), r.setAttribute("onerror", "this.src='img/languages/generic.png';"); var i = document.createTextNode(e); s.appendChild(o), o.appendChild(r), o.appendChild(i), document.getElementById("languages").appendChild(s) } function mdm_set_current_language(e, t) { var n = t.toLowerCase(); n = n.replace(".utf-8", ""), bits = n.split("_"), 2 == bits.length && (n = bits[1]), document.getElementById("current_language_flag").src = "img/languages/" + n + ".png", document.getElementById("current_language_flag").title = e, $("#selected_language_text").html(e) } function mdm_hide_shutdown() { document.getElementById("shutdown").style.display = "none" } function mdm_hide_suspend() { document.getElementById("suspend").style.display = "none" } function mdm_hide_restart() { document.getElementById("restart").style.display = "none" } function mdm_hide_quit() { document.getElementById("quit").style.display = "none" } function mdm_hide_xdmcp() { document.getElementById("xdmcp").style.display = "none" } maxUsersShown <= 0 && (maxUsersShown = 4), set_up_screen();